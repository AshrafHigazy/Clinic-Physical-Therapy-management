@model Clinic_Management_System.Models.Package
@{
    ViewData["Title"] = "تعديل بيانات الباقة";
}

<div class="container py-4">
    <div class="card card-modern">
        <h3 class="text-center text-warning fw-bold mb-4">
            <i class="bi bi-pencil-square"></i> تعديل بيانات الباقة
        </h3>

        <form asp-action="Edit" method="post" class="w-75 mx-auto">
            <input type="hidden" asp-for="Id" />

            <!-- 🔹 المريض -->
            <div class="mb-3">
                <label class="form-label fw-semibold text-primary">المريض</label>
                <input type="text"
                       class="form-control border-2 rounded-3"
                       style="border-color:#00B4D8;"
                       value="@Model.Patient?.FullName"
                       readonly />
                <input type="hidden" asp-for="PatientId" />
            </div>

            <!-- 🔹 الطبيب المتدرب -->
            <div class="mb-3">
                <label asp-for="InternDoctorId" class="form-label fw-semibold text-primary">الطبيب المتدرب</label>
                <select asp-for="InternDoctorId"
                        class="form-select border-2 rounded-3"
                        style="border-color:#00B4D8;"
                        id="InternDoctorId">
                    <option value="">-- اختر الطبيب --</option>
                    @foreach (var doctor in (List<Clinic_Management_System.Models.InternDoctor>)ViewBag.Doctors)
                    {
                        <option value="@doctor.InternDoctorId"
                                @@(doctor.InternDoctorId == Model.InternDoctorId ? "selected" : "")>
                            @doctor.FullName
                        </option>
                    }
                </select>
                <span asp-validation-for="InternDoctorId" class="text-danger small"></span>
            </div>

            <!-- 🔹 المؤسسة -->
            <div class="mb-3">
                <label asp-for="OrganizationId" class="form-label fw-semibold text-primary">المؤسسة</label>
                <select asp-for="OrganizationId"
                        class="form-select border-2 rounded-3"
                        style="border-color:#00B4D8;">
                    <option value="">-- اختر المؤسسة --</option>
                    @foreach (var org in (List<Clinic_Management_System.Models.Organization>)ViewBag.Organizations)
                    {
                        <option value="@org.Id"
                               @@(org.Id == Model.OrganizationId ? "selected" : "")>
                            @org.Name
                        </option>
                    }
                </select>
                <span asp-validation-for="OrganizationId" class="text-danger small"></span>
            </div>

            <!-- 🔹 الفحص -->
            <div class="mb-3">
                <label asp-for="CheckId" class="form-label fw-semibold text-primary">الفحص</label>
                <select asp-for="CheckId"
                        class="form-select border-2 rounded-3"
                        style="border-color:#00B4D8;">
                    <option value="">-- اختر الفحص --</option>
                    @foreach (var check in (List<Clinic_Management_System.Models.Check>)ViewBag.Checks)
                    {
                        <option value="@check.CheckId"
                                @@(check.CheckId == Model.CheckId ? "selected" : "")>
                            @check.Diagnosis
                        </option>
                    }
                </select>
                <span asp-validation-for="CheckId" class="text-danger small"></span>
            </div>

            <!-- 🔹 نوع الباقة -->
            <div class="mb-3">
                <label asp-for="Type" class="form-label fw-semibold text-primary">نوع الباقة</label>
                <select asp-for="Type"
                        class="form-select border-2 rounded-3"
                        style="border-color:#00B4D8;">
                    <option value="">-- اختر نوع الباقة --</option>
                    @foreach (var type in Enum.GetValues(typeof(Clinic_Management_System.Models.Enums.PackageType)))
                    {
                        <option value="@type">@type</option>
                    }
                </select>
                <span asp-validation-for="Type" class="text-danger small"></span>
            </div>

            <!-- 🔹 عدد الجلسات -->
            <div class="mb-3">
                <label asp-for="NumOfSessions" class="form-label fw-semibold text-primary">عدد الجلسات</label>
                <input asp-for="NumOfSessions"
                       class="form-control border-2 rounded-3"
                       style="border-color:#00B4D8;" />
                <span asp-validation-for="NumOfSessions" class="text-danger small"></span>
            </div>

            <!-- 🔹 المبلغ المدفوع -->
            <div class="mb-3">
                <label asp-for="AmountPaid" class="form-label fw-semibold text-primary">المبلغ المدفوع</label>
                <input asp-for="AmountPaid"
                       class="form-control border-2 rounded-3"
                       style="border-color:#00B4D8;"
                       type="number" step="0.01" min="0" />
                <span asp-validation-for="AmountPaid" class="text-danger small"></span>
            </div>

            <!-- 🔹 الحالة -->
            <div class="mb-3">
                <label asp-for="Status" class="form-label fw-semibold text-primary">الحالة</label>
                <select asp-for="Status"
                        class="form-select border-2 rounded-3"
                        style="border-color:#00B4D8;">
                    <option value="">-- اختر الحالة --</option>
                    <option value="Active" @@(Model.Status == "Active" ? "selected" : "")>نشطة</option>
                    <option value="Ended" @@(Model.Status == "Ended" ? "selected" : "")>منتهية</option>
                </select>
                <span asp-validation-for="Status" class="text-danger small"></span>
            </div>

            <!-- 🔘 الأزرار -->
            <div class="text-center mt-4">
                <button type="submit" class="btn btn-warning text-white px-4 rounded-pill">
                    <i class="bi bi-save"></i> حفظ التعديلات
                </button>
                <button type="button" class="btn btn-secondary rounded-pill px-4" onclick="history.back();">
                    🔙 رجوع
                </button>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <style>
        /* 🎨 النمط الموحد لجميع صفحات التعديل */
        .card-modern {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 119, 182, 0.45);
            padding: 30px;
            border: 2px solid #0077B6;
            animation: fadeIn 0.4s ease;
        }

        .form-label {
            color: #0077B6;
            font-weight: 600;
        }

        .form-control,
        .form-select {
            border-radius: 10px;
            border: 2px solid #00B4D8;
            transition: all 0.3s ease;
        }

            .form-control:focus,
            .form-select:focus {
                border-color: #0077B6;
                box-shadow: 0 0 0 0.2rem rgba(0, 183, 255, 0.25);
            }

        .btn-warning {
            background-color: #ffb703;
            border-color: #ffb703;
        }

            .btn-warning:hover {
                background-color: #ffa500;
                border-color: #ff9900;
            }

        .btn-outline-secondary:hover {
            background-color: #e2e6ea;
            color: #333;
        }

        @@keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
}
